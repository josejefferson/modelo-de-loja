<% 

let name, address, phone, email, other
if (data.length) {
	name = data[0].name
	address = data[0].address
	phone = data[0].phone
	email = data[0].email
	other = data[0].other
}

%>

<div class="container my-4">
	<h1>Comprar</h1>

	<div class="row">
		<div class="col col-12 col-md-4 col-lg-3">
			<div class="card">
				<% if (product[0].image) { %>
				<img src="<%= product[0].image %>" class="card-img-top">
				<% } %>
				<div class="card-body">
					<h5 class="card-title"><%= product[0].name %></h5>
					<p class="card-text"><%- product[0].description.replace(/\n/g, '<br>') %></p>
				</div>
				<div class="card-footer text-muted">
					<% if (product[0].stock) { %>
					<div>R$<%= product[0].price.replace('.',',') %> (<%= product[0].stock %> em estoque)</div>
					<% } else { %>
					R$<%= product[0].price.replace('.',',') %> (Esgotado)
					<% } %>
				</div>
			</div>
		</div>

		<div class="col col-12 col-md-8 col-lg-9">

			<form action="/buy" method="POST">
				<input type="hidden" name="product" value="<%= product[0].id %>">

				<h3>Comprar como:</h3>
				<% users.forEach((user, i) => { %>
				<label class="card user">
					<div class="card-body">
						<div class="row">
							<div class="col col-1 d-flex align-items-center text-center">
								<input type="radio" name="clientId" value="<%= user.clientId %>"<%= i == 0 ? ' checked' : '' %>>
							</div>
							<div class="col col-10 col-sm-11">
								<h4><%= user.name %></h4>
								<div><b>Endereço:</b> <%= user.address %></div>
								<div><b>Telefone:</b> <%= user.phone %></div>
								<div><b>E-mail:</b> <%= user.email %></div>
							</div>
						</div>
					</div>
				</label>
				<% }) %>
				
				<label class="form-group d-block">
					<div>Observações</div>
					<textarea class="form-control" name="other" placeholder="Mais alguma informação?"><%= other %></textarea>
				</label>

				<button class="btn btn-success" type="submit">Comprar</button>
			</form>
		</div>
	</div>
</div>